import pandas as pd
from sklearn.preprocessing import OneHotEncoder, LabelEncoder
import joblib

# Load the CSV file
file_path = '/content/knowxlsx.csv'
df = pd.read_csv(file_path)

# Transpose the dataframe so that each value has an associated label
df_t = df.set_index('label').T
df_t = df_t.melt(var_name='label', value_name='value')

# Drop missing values if any
df_t.dropna(inplace=True)

# Encode the labels
label_encoder = LabelEncoder()
df_t['label_encoded'] = label_encoder.fit_transform(df_t['label'])

# Save the label encoder for later use
joblib.dump(label_encoder, 'label_encoder.pkl')

# Assuming 'value' column contains categorical data, encode using OneHotEncoder
# Adjust this part based on the nature of your 'value' column
# If 'value' is numeric and continuous, OneHotEncoder might not be necessary
value_encoder = OneHotEncoder(sparse=False)
X = value_encoder.fit_transform(df_t[['value']])

# Save the value encoder for later use
joblib.dump(value_encoder, 'value_encoder.pkl')

y = df_t['label_encoded']

# Print or inspect X and y to ensure they are as expected
print(X.shape)  # Check the shape of X to verify encoding

# Optionally, you can inspect the first few rows of df_t to ensure correct encoding
# df_t.head()
